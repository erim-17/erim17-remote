cd C:\Users\erim.aylak\Desktop\asfat-remote\public

# Yeni index.html oluÅŸtur (tam Ã§alÄ±ÅŸan)
@'
<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸš€ ASFAT Remote - CANLI</title>
    <style>
        /* ... Ã¶nceki CSS aynÄ± kalacak ... */
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">ðŸš€</div>
            <h1>ASFAT Remote - CANLI</h1>
            <p class="tagline">GerÃ§ek zamanlÄ± ekran paylaÅŸÄ±mÄ±</p>
        </header>
        
        <!-- AynÄ± HTML yapÄ±sÄ± -->
        
    </div>

    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <script>
        // ========== KONFÄ°GÃœRASYON ==========
        const CONFIG = {
            SERVER_URL: 'https://asfat-remote-backend.onrender.com',
            CAPTURE_FPS: 10,
            MAX_QUALITY: 0.7
        };
        
        // ========== STATE ==========
        let state = {
            socket: null,
            currentRoom: null,
            localStream: null,
            isSharing: false,
            isConnected: false,
            captureInterval: null,
            canvas: null,
            ctx: null,
            video: null
        };
        
        // ========== DOM ELEMENTLERÄ° ==========
        const elements = {
            statusCard: document.getElementById('statusCard'),
            statusText: document.getElementById('statusText'),
            roomId: document.getElementById('roomId'),
            joinBtn: document.getElementById('joinBtn'),
            shareBtn: document.getElementById('shareBtn'),
            localScreen: document.getElementById('localScreen'),
            remoteScreen: document.getElementById('remoteScreen'),
            localPlaceholder: document.getElementById('localPlaceholder'),
            remotePlaceholder: document.getElementById('remotePlaceholder'),
            log: document.getElementById('log')
        };
        
        // ========== LOG SÄ°STEMÄ° ==========
        function log(message, type = 'info') {
            const time = new Date().toLocaleTimeString();
            const logEntry = `<div class="log-entry ${type}">[${time}] ${message}</div>`;
            elements.log.innerHTML = logEntry + elements.log.innerHTML;
        }
        
        // ========== SOCKET BAÄžLANTISI ==========
        function connectSocket() {
            log('ðŸ”— Backend\'e baÄŸlanÄ±lÄ±yor...');
            
            state.socket = io(CONFIG.SERVER_URL, {
                transports: ['websocket', 'polling']
            });
            
            state.socket.on('connect', () => {
                log('âœ… Backend\'e baÄŸlandÄ±', 'success');
                elements.statusText.innerHTML = 'ðŸŸ¢ BaÄŸlÄ±';
                elements.shareBtn.disabled = false;
            });
            
            state.socket.on('disconnect', () => {
                log('âŒ BaÄŸlantÄ± kesildi', 'error');
                elements.statusText.innerHTML = 'ðŸ”´ BaÄŸlantÄ± kesildi';
            });
            
            // EKRAN VERÄ°SÄ° ALMA
            state.socket.on('receive-screen-data', (data) => {
                if (data.imageData) {
                    elements.remoteScreen.src = data.imageData;
                    elements.remotePlaceholder.style.display = 'none';
                    log('ðŸ“º Uzak ekran gÃ¼ncellendi', 'success');
                }
            });
            
            // KULLANICI BAÄžLANTILARI
            state.socket.on('user-connected', (userId) => {
                log(`ðŸ‘¤ Yeni kullanÄ±cÄ±: ${userId}`);
            });
            
            state.socket.on('peer-joined', (data) => {
                log(`ðŸ‘¥ "${data.username}" odaya katÄ±ldÄ±`);
            });
        }
        
        // ========== ODAYA KATIL ==========
        function joinRoom() {
            const roomId = elements.roomId.value.trim();
            if (!roomId) {
                alert('Oda ID girin!');
                return;
            }
            
            if (!state.socket.connected) {
                alert('Backend\'e baÄŸlÄ± deÄŸil!');
                return;
            }
            
            const username = `KullanÄ±cÄ±_${Math.floor(Math.random() * 1000)}`;
            
            state.socket.emit('join-room', roomId, username);
            state.currentRoom = roomId;
            
            log(`ðŸ“¦ "${roomId}" odasÄ±na katÄ±ldÄ±nÄ±z`, 'success');
            elements.joinBtn.disabled = true;
            elements.joinBtn.innerHTML = `âœ… "${roomId}" odasÄ±nda`;
        }
        
        // ========== EKRAN PAYLAÅžIMI ==========
        async function shareScreen() {
            if (state.isSharing) {
                stopSharing();
                return;
            }
            
            if (!state.currentRoom) {
                alert('Ã–nce odaya katÄ±lÄ±n!');
                return;
            }
            
            try {
                // 1. EkranÄ± al
                state.localStream = await navigator.mediaDevices.getDisplayMedia({
                    video: {
                        width: { ideal: 1024 },
                        height: { ideal: 768 },
                        frameRate: { ideal: CONFIG.CAPTURE_FPS }
                    },
                    audio: false
                });
                
                // 2. Yerel gÃ¶sterim
                elements.localScreen.srcObject = state.localStream;
                elements.localPlaceholder.style.display = 'none';
                
                // 3. Canvas oluÅŸtur (yakalama iÃ§in)
                state.canvas = document.createElement('canvas');
                state.ctx = state.canvas.getContext('2d');
                state.video = document.createElement('video');
                state.video.srcObject = state.localStream;
                state.video.play();
                
                // 4. EkranÄ± yakala ve gÃ¶nder
                state.captureInterval = setInterval(() => {
                    captureAndSendScreen();
                }, 1000 / CONFIG.CAPTURE_FPS);
                
                state.isSharing = true;
                elements.shareBtn.innerHTML = 'â¹ï¸ PaylaÅŸÄ±mÄ± Durdur';
                elements.shareBtn.classList.add('btn-danger');
                elements.shareBtn.classList.remove('btn-success');
                
                log('ðŸ“º Ekran paylaÅŸÄ±mÄ± BAÅžLADI', 'success');
                
            } catch (error) {
                log(`âŒ Hata: ${error.message}`, 'error');
            }
        }
        
        function captureAndSendScreen() {
            if (!state.video || !state.ctx || !state.socket || !state.currentRoom) return;
            
            try {
                // EkranÄ± yakala
                state.canvas.width = state.video.videoWidth;
                state.canvas.height = state.video.videoHeight;
                state.ctx.drawImage(state.video, 0, 0);
                
                // Resmi JPEG'e Ã§evir (sÄ±kÄ±ÅŸtÄ±r)
                const imageData = state.canvas.toDataURL('image/jpeg', CONFIG.MAX_QUALITY);
                
                // Backend'e gÃ¶nder
                state.socket.emit('send-screen-data', {
                    roomId: state.currentRoom,
                    imageData: imageData,
                    timestamp: Date.now()
                });
                
            } catch (error) {
                console.error('Ekran yakalama hatasÄ±:', error);
            }
        }
        
        function stopSharing() {
            if (state.captureInterval) {
                clearInterval(state.captureInterval);
                state.captureInterval = null;
            }
            
            if (state.localStream) {
                state.localStream.getTracks().forEach(track => track.stop());
                state.localStream = null;
            }
            
            elements.localScreen.srcObject = null;
            elements.localPlaceholder.style.display = 'flex';
            
            state.isSharing = false;
            elements.shareBtn.innerHTML = 'ðŸ“º Ekran PaylaÅŸ';
            elements.shareBtn.classList.remove('btn-danger');
            elements.shareBtn.classList.add('btn-success');
            
            log('â¹ï¸ Ekran paylaÅŸÄ±mÄ± DURDURULDU', 'warning');
        }
        
        // ========== SAYFA YÃœKLENDÄ°ÄžÄ°NDE ==========
        window.onload = function() {
            log('ðŸš€ ASFAT Remote baÅŸlatÄ±ldÄ±');
            connectSocket();
            
            // Enter tuÅŸu ile odaya katÄ±l
            elements.roomId.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') joinRoom();
            });
        };
    </script>
</body>
</html>
'@ | Out-File -FilePath index.html -Encoding UTF8 -Force

Write-Host "âœ… GÃ¼ncellenmiÅŸ index.html oluÅŸturuldu!" -ForegroundColor Green